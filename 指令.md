# 指令

在 Angular 中有三种类型的指令：
1. 组件
  即拥有模板的指令
2. 结构型指令
  通过添加和移除 DOM 元素改变 DOM 布局的指令。如：`NgFor` 和 `NgIf`。
3. 属性型指令
  改变元素、组件或其它指令的外观和行为的指令。如：内置的 `NgStyle` 指令可以同时修改元素的多个样式。

## 属性型指令
属性型指令用于改变一个 DOM 元素的外观或行为

### 创建一个简单的属性指令
属性型指令至少需要一个带有 `@Directive` 装饰器的控制器类。该装饰器`指定了一个用于标识属性的选择器。 控制器类实现了指令需要的指令行为`。<br>
接下来，我们定义一个属性选择器`myHighlight`，当用户把鼠标悬停在一个元素上时，改变它的背景色。<br>
我们这样来使用这个指令：
```
// src/app/app.component.html

<div myHighlight highlightColor="yellow">hello world!</div>
<div myHighlight [highlightColor]="color">hello world!</div>

// 由于给input数据属性起了别名，也可以像下边这样访问
<div myHighlight="yellow">hello world!</div>
<div [myHighlight]="color" defaultColor="white">hello world!</div>

```
1. 通过Cli来生成指令文件：
```
ng generate directive highlight
```
CLI 会创建 `src/app/highlight.directive.ts` 及相应的测试文件（.../spec.ts），并且在根模块 `AppModule` 中声明这个指令类。<br>
生成的 src/app/highlight.directive.ts 文件如下：
```
// src/app/highlight.directive.ts

// 在指令的构造函数中注入 ElementRef，来引用宿主 DOM 元素
// 注入HostListener，是为了响应用户引发的事件
// 使用 @Input 数据绑定向指令传递值
import { Directive, ElementRef, HostListener, Input} from '@angular/core';

@Directive({
  selector: '[myHighlight]'
})
export class HighlightDirective {
  constructor(el: ElementRef) {}

  @Input('myHighlight') highlightColor: string;
  @Input() defaultColor: string;

  @HostListener('mouseenter') onMouseEnter() {
    this.highlight(this.highlightColor || this.defaultColor || 'red');
  }

  @HostListener('mouseleave') onMouseLeave() {
    this.highlight(null);
  }

  private highlight(color: string) {\
    // ElementRef 通过其 nativeElement 属性给你了直接访问宿主 DOM 元素的能力。
    this.el.nativeElement.style.backgroundColor = color;
  }
}

```
@Directive 装饰器的配置属性中指定了该指令的 CSS 属性型选择器 `[appHighlight]`。这里的方括号([])表示它的属性型选择器。 Angular 会在模板中定位每个名叫 myHighlight 的元素，并且为这些元素加上本指令的逻辑。正因如此，这类指令被称为 属性选择器 。<br>
紧跟在 @Directive 元数据之后的就是该指令的控制器类，名叫 HighlightDirective，它包含了该指令的逻辑（目前为空逻辑）。

## 结构型指令
用来塑造或重塑 DOM 的结构，比如添加、移除或维护这些元素及其子元素。<br>
星号（`*`）被放在指令的属性名之前。它是一个微语法，而不是通常的模板表达式。 Angular 会解开这个语法糖，变成一个 `\<ng-template\>` 标记，包裹着宿主元素及其子元素。 每个结构型指令都可以用这个模板做点不同的事情。<br>
>你可以在一个宿主元素上应用多个属性型指令，但只能应用一个结构型指令。




